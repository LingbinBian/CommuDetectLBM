% Test GenLouvain
clear
clc

A1=[9,9,0,0,0,0,0,0,0;
   9,9,0,0,0,0,0,0,0;
   0,0,8,8,8,0,0,0,0;
   0,0,8,8,8,0,0,0,0;
   0,0,8,8,8,0,0,0,0;
   0,0,0,0,0,7,7,7,7;
   0,0,0,0,0,7,7,7,7;
   0,0,0,0,0,7,7,7,7;
   0,0,0,0,0,7,7,7,7;];

A2=[9,9,9,9,9,1,1,1,1;
   9,9,9,9,9,1,1,1,1;
   9,9,9,9,9,1,1,1,1;
   9,9,9,9,9,1,1,1,1;
   9,9,9,9,9,1,1,1,1;
   1,1,1,1,1,7,7,7,7;
   1,1,1,1,1,7,7,7,7;
   1,1,1,1,1,7,7,7,7;
   1,1,5,1,1,7,7,7,7;];

A3=[7,7,0,0,0,0,0,0,0;
    7,7,0,0,0,0,0,0,0;
    0,0,25,25,0,0,0,0,0;
    0,0,25,25,0,0,0,0,0;
    0,0,0,0,19,19,19,0,0;
    0,0,0,0,19,19,19,0,0;
    0,0,0,0,19,19,19,0,0;
    0,0,0,0,0,0,0,25,25;
    0,0,0,0,0,0,0,25,25;];
A={A1,A2,A3};

N=9;
T=3;
gamma=1;
omega=0.8;
[B,twom] = multicat(A,gamma,omega);
[S,Q]= iterated_genlouvain(B,'moverandw');
S=postprocess_categorical_multilayer(S);

Q=Q/twom;
S=reshape(S,N,T);

original_B=full(B);

